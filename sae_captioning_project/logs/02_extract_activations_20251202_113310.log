2025-12-02 11:33:14.124506: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-12-02 11:33:14.838409: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-12-02 11:33:15,855 - INFO - Loading model: google/gemma-3-4b-it
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
`torch_dtype` is deprecated! Use `dtype` instead!
2025-12-02 11:33:20,432 - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.05s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.21it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.17it/s]
2025-12-02 11:33:22,490 - INFO - Model loaded with dtype torch.float16
2025-12-02 11:33:22,490 - INFO - Model hidden size: 2560
2025-12-02 11:33:22,490 - INFO - Extracting layers: [2, 6, 10, 14, 18, 22, 26, 30]
2025-12-02 11:33:22,774 - INFO - Loaded 0 samples
2025-12-02 11:33:22,774 - INFO - Dataset size: 0
2025-12-02 11:33:22,774 - INFO - 
==================================================
2025-12-02 11:33:22,774 - INFO - Extracting activations for ENGLISH
2025-12-02 11:33:22,774 - INFO - ==================================================
Processing english: 0it [00:00, ?it/s]Processing english: 0it [00:00, ?it/s]
2025-12-02 11:33:22,775 - INFO - Saved english activations to checkpoints/activations_english.pt
2025-12-02 11:33:22,960 - INFO - 
==================================================
2025-12-02 11:33:22,960 - INFO - Extracting activations for ARABIC
2025-12-02 11:33:22,960 - INFO - ==================================================
Processing arabic: 0it [00:00, ?it/s]Processing arabic: 0it [00:00, ?it/s]
2025-12-02 11:33:22,960 - INFO - Saved arabic activations to checkpoints/activations_arabic.pt
2025-12-02 11:33:23,119 - INFO - 
Activation extraction complete!
