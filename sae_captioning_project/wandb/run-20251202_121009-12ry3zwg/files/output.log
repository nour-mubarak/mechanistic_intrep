2025-12-02 12:10:47,603 - INFO - Wandb initialized: https://wandb.ai/nourmubarak/sae-captioning-bias/runs/12ry3zwg
2025-12-02 12:10:47,603 - INFO - Loading model: google/gemma-3-4b-it
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
`torch_dtype` is deprecated! Use `dtype` instead!
2025-12-02 12:10:52,390 - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.87s/it]
2025-12-02 12:10:56,461 - INFO - Model loaded with dtype torch.float16
2025-12-02 12:10:56,461 - INFO - Model hidden size: 2560
2025-12-02 12:10:56,461 - INFO - Extracting layers: [2, 6, 10, 14, 18, 22, 26, 30]
2025-12-02 12:10:56,768 - INFO - Loaded 2000 samples
2025-12-02 12:10:56,769 - INFO - Dataset size: 2000
2025-12-02 12:10:56,769 - INFO -
==================================================
2025-12-02 12:10:56,769 - INFO - Extracting activations for ENGLISH
2025-12-02 12:10:56,769 - INFO - ==================================================
Processing english:  25%|██▍       | 499/2000 [02:14<05:38,  4.44it/s]2025-12-02 12:13:15,912 - INFO - Saved checkpoint 0 with 500 samples
Processing english:  50%|████▉     | 999/2000 [04:22<03:48,  4.39it/s]2025-12-02 12:15:23,148 - INFO - Saved checkpoint 1 with 500 samples
Processing english:  75%|███████▍  | 1499/2000 [06:28<01:53,  4.41it/s]2025-12-02 12:17:29,788 - INFO - Saved checkpoint 2 with 500 samples
Processing english: 100%|█████████▉| 1999/2000 [08:35<00:00,  4.44it/s]2025-12-02 12:19:36,092 - INFO - Saved checkpoint 3 with 500 samples
Processing english: 100%|██████████| 2000/2000 [08:39<00:00,  3.85it/s]
2025-12-02 12:19:36,455 - INFO - Merging 4 checkpoint files...
2025-12-02 12:19:47,999 - INFO - Layer 2: torch.Size([2000, 278, 2560])
