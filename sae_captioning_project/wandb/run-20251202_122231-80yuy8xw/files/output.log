2025-12-02 12:22:32,401 - INFO - Wandb initialized: https://wandb.ai/nourmubarak/sae-captioning-bias/runs/80yuy8xw
2025-12-02 12:22:32,401 - INFO - Loading model: google/gemma-3-4b-it
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
`torch_dtype` is deprecated! Use `dtype` instead!
2025-12-02 12:22:37,209 - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.97s/it]
2025-12-02 12:22:41,485 - INFO - Model loaded with dtype torch.float16
2025-12-02 12:22:41,485 - INFO - Model hidden size: 2560
2025-12-02 12:22:41,485 - INFO - Extracting layers: [2, 6, 10, 14, 18, 22, 26, 30]
2025-12-02 12:22:41,790 - INFO - Loaded 2000 samples
2025-12-02 12:22:41,790 - INFO - Dataset size: 2000
2025-12-02 12:22:41,790 - INFO -
==================================================
2025-12-02 12:22:41,790 - INFO - Extracting activations for ENGLISH
2025-12-02 12:22:41,790 - INFO - ==================================================
Processing english:   2%|▏         | 49/2000 [00:12<07:41,  4.22it/s]2025-12-02 12:22:55,482 - INFO - Saved checkpoint 0 with 50 samples
Processing english:   5%|▍         | 99/2000 [00:26<07:46,  4.08it/s]2025-12-02 12:23:09,292 - INFO - Saved checkpoint 1 with 50 samples
Processing english:   7%|▋         | 149/2000 [00:39<07:12,  4.28it/s]2025-12-02 12:23:22,540 - INFO - Saved checkpoint 2 with 50 samples
Processing english:  10%|▉         | 199/2000 [00:52<06:39,  4.51it/s]2025-12-02 12:23:35,243 - INFO - Saved checkpoint 3 with 50 samples
Processing english:  12%|█▏        | 249/2000 [01:05<06:38,  4.39it/s]2025-12-02 12:23:47,909 - INFO - Saved checkpoint 4 with 50 samples
Processing english:  15%|█▍        | 299/2000 [01:17<06:19,  4.49it/s]2025-12-02 12:24:00,351 - INFO - Saved checkpoint 5 with 50 samples
Processing english:  17%|█▋        | 349/2000 [01:30<06:09,  4.47it/s]2025-12-02 12:24:12,920 - INFO - Saved checkpoint 6 with 50 samples
Processing english:  20%|█▉        | 399/2000 [01:43<06:01,  4.42it/s]2025-12-02 12:24:25,643 - INFO - Saved checkpoint 7 with 50 samples
Processing english:  22%|██▏       | 449/2000 [01:55<05:57,  4.34it/s]2025-12-02 12:24:38,308 - INFO - Saved checkpoint 8 with 50 samples
Processing english:  25%|██▍       | 499/2000 [02:08<05:34,  4.49it/s]2025-12-02 12:24:51,123 - INFO - Saved checkpoint 9 with 50 samples
Processing english:  27%|██▋       | 549/2000 [02:21<05:25,  4.46it/s]2025-12-02 12:25:03,919 - INFO - Saved checkpoint 10 with 50 samples
Processing english:  30%|██▉       | 599/2000 [02:34<05:27,  4.27it/s]2025-12-02 12:25:16,724 - INFO - Saved checkpoint 11 with 50 samples
Processing english:  32%|███▏      | 649/2000 [02:46<05:01,  4.48it/s]2025-12-02 12:25:29,196 - INFO - Saved checkpoint 12 with 50 samples
Processing english:  35%|███▍      | 699/2000 [02:59<04:51,  4.47it/s]2025-12-02 12:25:41,740 - INFO - Saved checkpoint 13 with 50 samples
Processing english:  37%|███▋      | 749/2000 [03:12<04:40,  4.46it/s]2025-12-02 12:25:54,582 - INFO - Saved checkpoint 14 with 50 samples
Processing english:  40%|███▉      | 799/2000 [03:24<04:28,  4.47it/s]2025-12-02 12:26:07,114 - INFO - Saved checkpoint 15 with 50 samples
Processing english:  42%|████▏     | 849/2000 [03:37<04:18,  4.45it/s]2025-12-02 12:26:19,895 - INFO - Saved checkpoint 16 with 50 samples
Processing english:  45%|████▍     | 899/2000 [03:50<04:11,  4.37it/s]2025-12-02 12:26:32,687 - INFO - Saved checkpoint 17 with 50 samples
Processing english:  47%|████▋     | 949/2000 [04:03<04:08,  4.23it/s]2025-12-02 12:26:45,482 - INFO - Saved checkpoint 18 with 50 samples
Processing english:  50%|████▉     | 999/2000 [04:15<03:45,  4.44it/s]2025-12-02 12:26:58,170 - INFO - Saved checkpoint 19 with 50 samples
Processing english:  52%|█████▏    | 1049/2000 [04:28<03:41,  4.30it/s]2025-12-02 12:27:10,840 - INFO - Saved checkpoint 20 with 50 samples
Processing english:  55%|█████▍    | 1099/2000 [04:41<03:22,  4.45it/s]2025-12-02 12:27:23,558 - INFO - Saved checkpoint 21 with 50 samples
Processing english:  57%|█████▋    | 1149/2000 [04:53<03:13,  4.40it/s]2025-12-02 12:27:36,246 - INFO - Saved checkpoint 22 with 50 samples
Processing english:  60%|█████▉    | 1199/2000 [05:06<03:03,  4.37it/s]2025-12-02 12:27:49,026 - INFO - Saved checkpoint 23 with 50 samples
Processing english:  62%|██████▏   | 1249/2000 [05:19<02:50,  4.39it/s]2025-12-02 12:28:01,685 - INFO - Saved checkpoint 24 with 50 samples
Processing english:  65%|██████▍   | 1299/2000 [05:32<02:47,  4.19it/s]2025-12-02 12:28:14,588 - INFO - Saved checkpoint 25 with 50 samples
Processing english:  67%|██████▋   | 1349/2000 [05:44<02:27,  4.42it/s]2025-12-02 12:28:27,258 - INFO - Saved checkpoint 26 with 50 samples
Processing english:  70%|██████▉   | 1399/2000 [05:57<02:16,  4.40it/s]2025-12-02 12:28:39,917 - INFO - Saved checkpoint 27 with 50 samples
Processing english:  72%|███████▏  | 1449/2000 [06:10<02:03,  4.48it/s]2025-12-02 12:28:52,733 - INFO - Saved checkpoint 28 with 50 samples
Processing english:  75%|███████▍  | 1499/2000 [06:22<01:53,  4.40it/s]2025-12-02 12:29:05,330 - INFO - Saved checkpoint 29 with 50 samples
Processing english:  77%|███████▋  | 1549/2000 [06:35<01:41,  4.44it/s]2025-12-02 12:29:18,243 - INFO - Saved checkpoint 30 with 50 samples
Processing english:  80%|███████▉  | 1599/2000 [06:48<01:30,  4.44it/s]2025-12-02 12:29:30,837 - INFO - Saved checkpoint 31 with 50 samples
Processing english:  82%|████████▏ | 1649/2000 [07:01<01:24,  4.15it/s]2025-12-02 12:29:43,672 - INFO - Saved checkpoint 32 with 50 samples
Processing english:  85%|████████▍ | 1699/2000 [07:14<01:08,  4.42it/s]2025-12-02 12:29:56,419 - INFO - Saved checkpoint 33 with 50 samples
Processing english:  87%|████████▋ | 1749/2000 [07:26<00:58,  4.33it/s]2025-12-02 12:30:09,078 - INFO - Saved checkpoint 34 with 50 samples
Processing english:  90%|████████▉ | 1799/2000 [07:39<00:48,  4.11it/s]2025-12-02 12:30:22,359 - INFO - Saved checkpoint 35 with 50 samples
Processing english:  92%|█████████▏| 1849/2000 [07:52<00:33,  4.55it/s]2025-12-02 12:30:34,670 - INFO - Saved checkpoint 36 with 50 samples
Processing english:  95%|█████████▍| 1899/2000 [08:04<00:22,  4.54it/s]2025-12-02 12:30:47,153 - INFO - Saved checkpoint 37 with 50 samples
Processing english:  97%|█████████▋| 1949/2000 [08:17<00:11,  4.52it/s]2025-12-02 12:30:59,454 - INFO - Saved checkpoint 38 with 50 samples
Processing english: 100%|█████████▉| 1999/2000 [08:29<00:00,  4.29it/s]2025-12-02 12:31:12,120 - INFO - Saved checkpoint 39 with 50 samples
Processing english: 100%|██████████| 2000/2000 [08:30<00:00,  3.92it/s]
2025-12-02 12:31:12,342 - INFO - Merging 40 checkpoint files...
2025-12-02 12:31:24,866 - INFO - Layer 2: torch.Size([2000, 278, 2560])
2025-12-02 12:31:25,221 - INFO - Layer 6: torch.Size([2000, 278, 2560])
